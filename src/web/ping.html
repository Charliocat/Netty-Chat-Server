<!--ping.html-->
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.4/angular-material.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angular-ui-router/1.0.0-rc.1/angular-ui-router.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
<html>
    <body>
        
        <div ng-app="myApp" ng-controller="myCtrl">
            <button type="button" ng-click="connect()" class="btn">{{action}}</button>
        </div>

    </body>
</html>

<script>


var socket = new WebSocket("ws://localhost:8080/websocket");
var connected = (socket.getReadyState == 1) ? true : false;

var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope) {
    $scope.action = (socket.getReadyState == 1) ? 'Disconnect' : 'Connect';
    $scope.connect = function() {
        
        if (connected) {
            console.log('disconnecting');
            socket.close();
            
            $scope.action = 'Connect';
            connected = false;
        }
        //if dc
        else {
            console.log('connecting');
            socket = new WebSocket("ws://localhost:8080/websocket");
            connected = true;
            $scope.action = 'Disconnect';
        }
    }
});

</script>